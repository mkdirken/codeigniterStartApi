<?php

class auth_model extends CI_Model {


    function __construct(){
        parent::__construct();
        $this->load->database();  // CONNECT DATABASE
       
    }



// * ///////////////////////////////////////////////////////////////////////////////////////////
// !  ///////////////////////////////    AUTH     //////////////////////////////////////////////
// * ///////////////////////////////////////////////////////////////////////////////////////////    

    ////////////////////////////////////////////////////////////////////////////////////////////
    // Mail Login to the system 
    ////////////////////////////////////////////////////////////////////////////////////////////
    public function _email_login($EMAIL,$PASSWORD){
       return $QUERY=$this->db->where(array('email'=>$EMAIL,'password'=>hash('sha512', sha1($PASSWORD)),'deleted_at'=>null))->get('users')->row();
    }
     ////////////////////////////////////////////////////////////////////////////////////////////
    // Mail Login to the system
    ////////////////////////////////////////////////////////////////////////////////////////////


    ////////////////////////////////////////////////////////////////////////////////////////////
    // Phone Login to the system
    ////////////////////////////////////////////////////////////////////////////////////////////
    public function _phone_login($COUNTRY_CODE,$PHONE,$PASSWORD){
        return $QUERY=$this->db->where(array('country_code'=>$COUNTRY_CODE,'phone'=>$PHONE,'password'=>hash('sha512', sha1($PASSWORD)),'deleted_at'=>null))->get('users')->row();
     }
      ////////////////////////////////////////////////////////////////////////////////////////////
     // Phone Login to the system
     ////////////////////////////////////////////////////////////////////////////////////////////

// * ///////////////////////////////////////////////////////////////////////////////////////////
// !  ///////////////////////////////  END  AUTH     //////////////////////////////////////////////
// * /////////////////////////////////////////////////////////////////////////////////////////// 


}